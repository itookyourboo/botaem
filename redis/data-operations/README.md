# Операции с данными Redis

Использование основных команд Redis, таких как SET, GET, EXPIRE и других.

---

## SET

`SET` - команда, которая используется для установки значения ключа в Redis. Синтаксис команды `SET` выглядит следующим
образом:

```redis
SET key value [EX seconds] [PX milliseconds] [NX|XX]
```

где:

- `key` - ключ, для которого устанавливается значение;
- `value` - устанавливаемое значение;
- `EX seconds` или `PX milliseconds` - время жизни ключа (в секундах или миллисекундах);
- `NX` или `XX` - флаги, которые указывают, что новое значение может быть установлено только если ключ не существует (`NX`) или уже существует (`XX`).

## GET

`GET` - команда, которая используется для получения значения ключа в Redis. Синтаксис команды `GET` выглядит следующим образом:

```redis
GET key
```

где key - ключ, значение которого необходимо получить.

## EXPIRE

`EXPIRE` - команда, которая используется для установки времени жизни ключа в Redis. Синтаксис команды `EXPIRE` выглядит следующим образом:

```redis
EXPIRE key seconds
```

где:

- key - ключ, для которого устанавливается время жизни;
- seconds - время жизни ключа в секундах.

## EXISTS

`EXISTS` позволяет проверить, существует ли ключ или нет. Синтаксис команды `EXISTS` выглядит следующим образом:

```redis
EXISTS key
```

где key - ключ, наличие которого нужно проверить в базе.

## DEL

`DEL` - команда, которая используется для удаления ключа в Redis. Синтаксис команды `DEL` выглядит следующим образом:

```redis
DEL key [key ...]
```

## INCR и DECR

`INCR` и `DECR` - команды, которые используются для увеличения и уменьшения значения ключа в Redis соответственно. Синтаксис команд `INCR` и `DECR` выглядит следующим образом:

```redis
INCR key
DECR key
```

где key - ключ, значение которого необходимо увеличить или уменьшить.

Полный список команд можно найти [в официальной документации](https://redis.io/commands/).

---

# Практическое задание

Вы являетесь разработчиком онлайн-магазина и хотите использовать Redis- для хранения информации о продуктах и заказах. Вам нужно создать эффективную структуру данных в redis-cli для хранения информации о продуктах и заказах, а также научиться манипулировать данными с помощью различных команд и операций.

**Шаг 1**: Создайте хэш "product:id" для каждого продукта, где "id" - уникальный идентификатор продукта. В хэше должны быть следующие поля:

- "name" - название продукта
- "description" - описание продукта
- "price" - цена продукта
- "image" - ссылка на изображение продукта

Например, создайте хэши для продуктов "product:1", "product:2" и "product:3":

```redis
HMSET product:1 name "iPhone 12" description "The latest iPhone" price 999.99 image "https://example.com/iphone12.jpg"
HMSET product:2 name "Samsung Galaxy S21" description "The latest Samsung phone" price 799.99 image "https://example.com/galaxys21.jpg"
HMSET product:3 name "Google Pixel 5" description "The latest Google phone" price 699.99 image "https://example.com/pixel5.jpg"
```

**Шаг 2**: Создайте сортированный набор "products" для хранения информации о всех продуктах. Добавьте в него элементы с помощью команды "ZADD", где ключ - "products", оценка - цена продукта, а значение - "product:id". Например:

```redis
ZADD products 999.99 product:1 799.99 product:2 699.99 product:3
```

**Шаг 3**: Создайте хэш "order:id" для каждого заказа, где "id" - уникальный идентификатор заказа. В хэше должны быть следующие поля:

- "user_id" - идентификатор пользователя, который сделал заказ
- "status" - статус заказа (например, "in_progress", "shipped", "delivered")
- "products" - список продуктов в заказе и их количество (например, "product:1" - 2 шт., "product:2" - 1 шт.)

Например, создайте хэши для заказов "order:1", "order:2" и "order:3":

```redis
HMSET order:1 user_id 1 status "in_progress" products "product:1:2,product:2:1"
HMSET order:2 user_id 2 status "shipped" products "product:3:1"
HMSET order:3 user_id 3 status "delivered" products "product:1:1,product:2:2"
```

**Шаг 4**: Создайте сортированный набор "orders" для хранения информации о всех заказах. Добавьте в него элементы с помощью команды "ZADD", где ключ - "orders", оценка - идентификатор заказа, а значение - "order:id". Например:

```redis
ZADD orders 1 order:1 2 order:2 3 order:3
```

**Шаг 5**: Используйте команды "HGET" и "ZRANGE" для получения информации о продукте и заказе. Например, получите название продукта с идентификатором "1":

```redis
HGET product:1 name
```

Получите информацию о первых двух продуктах с самой высокой ценой:

```redis
ZRANGE products -2 -1 WITHSCORES
```

Получите список продуктов и их количество в заказе с идентификатором "1":

```redis
HGET order:1 products
```

**Шаг 6**: Используйте команды "HSET" и "ZINCRBY" для изменения информации о продукте и заказе. Например, измените цену продукта с идентификатором "1" на 1099.99:

```redis
HSET product:1 price 1099.99
```

Увеличьте количество продукта "product:1" в заказе с идентификатором "1" на 1:

```redis
ZINCRBY order:1:products 1 product:1
```

**Шаг 7**: Используйте команды "HDEL" и "ZREM" для удаления информации о продукте и заказе. Например, удалите информацию о продукте с идентификатором "3":

```redis
HDEL product:3 name descr price
```

Удалите информацию о заказе с идентификатором "2":

```redis
ZREM orders 2
DEL order:2
```

**Шаг 8**: Используйте команду "KEYS" для получения списка всех ключей в Redis-cli.

```redis
KEYS *
```

Результатом будет список всех ключей в Redis-cli.

**Шаг 9**: Используйте команду "FLUSHALL" для удаления всех данных в Redis-cli.

```redis
FLUSHALL
```

Эта команда удалит все ключи и значения в Redis-cli.

Поздравляем, вы успешно создали эффективную структуру данных в Redis-cli для хранения информации о продуктах и заказах, а также научились манипулировать данными с помощью различных команд и операций!
